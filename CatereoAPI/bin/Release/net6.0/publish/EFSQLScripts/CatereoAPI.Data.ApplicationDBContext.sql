CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE TABLE "AspNetRoles" (
        "Id" text NOT NULL,
        "Name" character varying(256) NULL,
        "NormalizedName" character varying(256) NULL,
        "ConcurrencyStamp" text NULL,
        CONSTRAINT "PK_AspNetRoles" PRIMARY KEY ("Id")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE TABLE "AspNetUsers" (
        "Id" text NOT NULL,
        "Name" text NULL,
        "Surname" text NULL,
        "Position" text NULL,
        "Role" text NULL,
        "MarginalRate" double precision NULL,
        "UserName" character varying(256) NULL,
        "NormalizedUserName" character varying(256) NULL,
        "Email" character varying(256) NULL,
        "NormalizedEmail" character varying(256) NULL,
        "EmailConfirmed" boolean NOT NULL,
        "PasswordHash" text NULL,
        "SecurityStamp" text NULL,
        "ConcurrencyStamp" text NULL,
        "PhoneNumber" text NULL,
        "PhoneNumberConfirmed" boolean NOT NULL,
        "TwoFactorEnabled" boolean NOT NULL,
        "LockoutEnd" timestamp with time zone NULL,
        "LockoutEnabled" boolean NOT NULL,
        "AccessFailedCount" integer NOT NULL,
        CONSTRAINT "PK_AspNetUsers" PRIMARY KEY ("Id")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE TABLE "AspNetRoleClaims" (
        "Id" integer GENERATED BY DEFAULT AS IDENTITY,
        "RoleId" text NOT NULL,
        "ClaimType" text NULL,
        "ClaimValue" text NULL,
        CONSTRAINT "PK_AspNetRoleClaims" PRIMARY KEY ("Id"),
        CONSTRAINT "FK_AspNetRoleClaims_AspNetRoles_RoleId" FOREIGN KEY ("RoleId") REFERENCES "AspNetRoles" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE TABLE "AspNetUserClaims" (
        "Id" integer GENERATED BY DEFAULT AS IDENTITY,
        "UserId" text NOT NULL,
        "ClaimType" text NULL,
        "ClaimValue" text NULL,
        CONSTRAINT "PK_AspNetUserClaims" PRIMARY KEY ("Id"),
        CONSTRAINT "FK_AspNetUserClaims_AspNetUsers_UserId" FOREIGN KEY ("UserId") REFERENCES "AspNetUsers" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE TABLE "AspNetUserLogins" (
        "LoginProvider" text NOT NULL,
        "ProviderKey" text NOT NULL,
        "ProviderDisplayName" text NULL,
        "UserId" text NOT NULL,
        CONSTRAINT "PK_AspNetUserLogins" PRIMARY KEY ("LoginProvider", "ProviderKey"),
        CONSTRAINT "FK_AspNetUserLogins_AspNetUsers_UserId" FOREIGN KEY ("UserId") REFERENCES "AspNetUsers" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE TABLE "AspNetUserRoles" (
        "UserId" text NOT NULL,
        "RoleId" text NOT NULL,
        CONSTRAINT "PK_AspNetUserRoles" PRIMARY KEY ("UserId", "RoleId"),
        CONSTRAINT "FK_AspNetUserRoles_AspNetRoles_RoleId" FOREIGN KEY ("RoleId") REFERENCES "AspNetRoles" ("Id") ON DELETE CASCADE,
        CONSTRAINT "FK_AspNetUserRoles_AspNetUsers_UserId" FOREIGN KEY ("UserId") REFERENCES "AspNetUsers" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE TABLE "AspNetUserTokens" (
        "UserId" text NOT NULL,
        "LoginProvider" text NOT NULL,
        "Name" text NOT NULL,
        "Value" text NULL,
        CONSTRAINT "PK_AspNetUserTokens" PRIMARY KEY ("UserId", "LoginProvider", "Name"),
        CONSTRAINT "FK_AspNetUserTokens_AspNetUsers_UserId" FOREIGN KEY ("UserId") REFERENCES "AspNetUsers" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE INDEX "IX_AspNetRoleClaims_RoleId" ON "AspNetRoleClaims" ("RoleId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE UNIQUE INDEX "RoleNameIndex" ON "AspNetRoles" ("NormalizedName");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE INDEX "IX_AspNetUserClaims_UserId" ON "AspNetUserClaims" ("UserId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE INDEX "IX_AspNetUserLogins_UserId" ON "AspNetUserLogins" ("UserId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE INDEX "IX_AspNetUserRoles_RoleId" ON "AspNetUserRoles" ("RoleId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE INDEX "EmailIndex" ON "AspNetUsers" ("NormalizedEmail");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    CREATE UNIQUE INDEX "UserNameIndex" ON "AspNetUsers" ("NormalizedUserName");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231009081916_Initial') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231009081916_Initial', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231012090553_Czasy pracy pracowników - obliczenia') THEN
    CREATE TABLE "EmployeesWorkingTime" (
        "userName" text NOT NULL,
        "Name" text NOT NULL,
        "Surname" text NOT NULL,
        "HourlyRate" double precision NOT NULL,
        "Hours" double precision NOT NULL,
        "Days" double precision NOT NULL,
        "MonthlySalary" double precision NOT NULL,
        "isActive" boolean NOT NULL,
        "isNotOlderThan26" boolean NOT NULL,
        "PensionContribution" double precision NOT NULL,
        "DisabilityContribution" double precision NOT NULL,
        "AccidentContribution" double precision NOT NULL,
        "LaborFoundContribution" double precision NOT NULL,
        "HealthCareContribution" double precision NOT NULL,
        "VacationDays" integer NOT NULL,
        CONSTRAINT "PK_EmployeesWorkingTime" PRIMARY KEY ("userName")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231012090553_Czasy pracy pracowników - obliczenia') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231012090553_Czasy pracy pracowników - obliczenia', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231023115150_Dodanie do bazy danych Warehouse') THEN
    CREATE TABLE "WarehouseData" (
        "ProductId" integer GENERATED BY DEFAULT AS IDENTITY,
        "ProductSKU" integer NOT NULL,
        "ProductName" text NOT NULL,
        "ProductDescription" text NULL,
        "ProductCategoryId" text NOT NULL,
        "ProductQuantity" integer NOT NULL,
        "ProductNettoPrice" double precision NOT NULL,
        "ProductVatRate" integer NOT NULL,
        "ProductExpiresDays" integer NULL,
        "ProductExpiresDate" timestamp with time zone NULL,
        CONSTRAINT "PK_WarehouseData" PRIMARY KEY ("ProductId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231023115150_Dodanie do bazy danych Warehouse') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231023115150_Dodanie do bazy danych Warehouse', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231123102158_Dodanie kilku elementów aplikacji - tabele') THEN
    CREATE TABLE "MenuCards" (
        "MenuCardId" integer GENERATED BY DEFAULT AS IDENTITY,
        "Date" timestamp with time zone NOT NULL,
        "IsBreakfast" boolean NOT NULL,
        "IsLunch" boolean NOT NULL,
        "IsDinner" boolean NOT NULL,
        "IsDessert" boolean NOT NULL,
        CONSTRAINT "PK_MenuCards" PRIMARY KEY ("MenuCardId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231123102158_Dodanie kilku elementów aplikacji - tabele') THEN
    CREATE TABLE "ProductCategories" (
        "ProductCategoryId" integer GENERATED BY DEFAULT AS IDENTITY,
        "CategoryName" text NOT NULL,
        "Description" text NOT NULL,
        CONSTRAINT "PK_ProductCategories" PRIMARY KEY ("ProductCategoryId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231123102158_Dodanie kilku elementów aplikacji - tabele') THEN
    CREATE TABLE "MenuItems" (
        "MenuItemId" integer GENERATED BY DEFAULT AS IDENTITY,
        "Name" text NOT NULL,
        "Description" text NOT NULL,
        "Category" text NOT NULL,
        "Price" numeric NOT NULL,
        "Availability" boolean NOT NULL,
        "Ingredients" text NOT NULL,
        "Image" text NOT NULL,
        "PopularityRating" integer NOT NULL,
        "AllergenInformation" text NOT NULL,
        "IsVegetarian" boolean NOT NULL,
        "IsVegan" boolean NOT NULL,
        "LastUpdated" timestamp with time zone NOT NULL,
        "MenuCardId" integer NOT NULL,
        CONSTRAINT "PK_MenuItems" PRIMARY KEY ("MenuItemId"),
        CONSTRAINT "FK_MenuItems_MenuCards_MenuCardId" FOREIGN KEY ("MenuCardId") REFERENCES "MenuCards" ("MenuCardId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231123102158_Dodanie kilku elementów aplikacji - tabele') THEN
    CREATE INDEX "IX_MenuItems_MenuCardId" ON "MenuItems" ("MenuCardId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231123102158_Dodanie kilku elementów aplikacji - tabele') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231123102158_Dodanie kilku elementów aplikacji - tabele', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124134117_Test zmian - MenuItem oraz MenuCard') THEN
    ALTER TABLE "MenuItems" DROP CONSTRAINT "FK_MenuItems_MenuCards_MenuCardId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124134117_Test zmian - MenuItem oraz MenuCard') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "MenuCardId" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124134117_Test zmian - MenuItem oraz MenuCard') THEN
    ALTER TABLE "MenuItems" ADD CONSTRAINT "FK_MenuItems_MenuCards_MenuCardId" FOREIGN KEY ("MenuCardId") REFERENCES "MenuCards" ("MenuCardId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124134117_Test zmian - MenuItem oraz MenuCard') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124134117_Test zmian - MenuItem oraz MenuCard', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124135933_Test zmian - MenuItem oraz MenuCard2') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124135933_Test zmian - MenuItem oraz MenuCard2', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124140045_Test zmian - MenuItem oraz MenuCard3') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "Ingredients" TYPE text;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124140045_Test zmian - MenuItem oraz MenuCard3') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124140045_Test zmian - MenuItem oraz MenuCard3', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124140107_Test zmian - MenuItem oraz MenuCard4') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "Ingredients" TYPE text[];
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124140107_Test zmian - MenuItem oraz MenuCard4') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124140107_Test zmian - MenuItem oraz MenuCard4', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124140631_Test zmian - MenuItem oraz MenuCard5') THEN
    ALTER TABLE "MenuItems" DROP COLUMN "Ingredients";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124140631_Test zmian - MenuItem oraz MenuCard5') THEN
    CREATE TABLE "Ingredient" (
        "IngredientId" integer GENERATED BY DEFAULT AS IDENTITY,
        "Name" text NOT NULL,
        "MenuItemId" integer NULL,
        CONSTRAINT "PK_Ingredient" PRIMARY KEY ("IngredientId"),
        CONSTRAINT "FK_Ingredient_MenuItems_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItems" ("MenuItemId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124140631_Test zmian - MenuItem oraz MenuCard5') THEN
    CREATE INDEX "IX_Ingredient_MenuItemId" ON "Ingredient" ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124140631_Test zmian - MenuItem oraz MenuCard5') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124140631_Test zmian - MenuItem oraz MenuCard5', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142046_Relacja wiele do wielu dla MenuItem Ingredients') THEN
    ALTER TABLE "Ingredient" DROP CONSTRAINT "FK_Ingredient_MenuItems_MenuItemId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142046_Relacja wiele do wielu dla MenuItem Ingredients') THEN
    DROP INDEX "IX_Ingredient_MenuItemId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142046_Relacja wiele do wielu dla MenuItem Ingredients') THEN
    ALTER TABLE "Ingredient" DROP COLUMN "MenuItemId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142046_Relacja wiele do wielu dla MenuItem Ingredients') THEN
    CREATE TABLE "MenuItemIngredient" (
        "MenuItemId" integer NOT NULL,
        "IngredientId" integer NOT NULL,
        "IngredientId1" integer NULL,
        CONSTRAINT "PK_MenuItemIngredient" PRIMARY KEY ("MenuItemId", "IngredientId"),
        CONSTRAINT "FK_MenuItemIngredient_Ingredient_IngredientId" FOREIGN KEY ("IngredientId") REFERENCES "Ingredient" ("IngredientId") ON DELETE CASCADE,
        CONSTRAINT "FK_MenuItemIngredient_Ingredient_IngredientId1" FOREIGN KEY ("IngredientId1") REFERENCES "Ingredient" ("IngredientId"),
        CONSTRAINT "FK_MenuItemIngredient_MenuItems_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItems" ("MenuItemId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142046_Relacja wiele do wielu dla MenuItem Ingredients') THEN
    CREATE INDEX "IX_MenuItemIngredient_IngredientId" ON "MenuItemIngredient" ("IngredientId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142046_Relacja wiele do wielu dla MenuItem Ingredients') THEN
    CREATE INDEX "IX_MenuItemIngredient_IngredientId1" ON "MenuItemIngredient" ("IngredientId1");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142046_Relacja wiele do wielu dla MenuItem Ingredients') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124142046_Relacja wiele do wielu dla MenuItem Ingredients', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142339_Relacja jeden do wielu dla MenuItem Ingredients') THEN
    ALTER TABLE "MenuItems" DROP CONSTRAINT "FK_MenuItems_MenuCards_MenuCardId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142339_Relacja jeden do wielu dla MenuItem Ingredients') THEN
    DROP TABLE "MenuItemIngredient";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142339_Relacja jeden do wielu dla MenuItem Ingredients') THEN
    ALTER TABLE "MenuItems" RENAME COLUMN "MenuCardId" TO "MenuId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142339_Relacja jeden do wielu dla MenuItem Ingredients') THEN
    ALTER INDEX "IX_MenuItems_MenuCardId" RENAME TO "IX_MenuItems_MenuId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142339_Relacja jeden do wielu dla MenuItem Ingredients') THEN
    ALTER TABLE "Ingredient" ADD "MenuItemId" integer NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142339_Relacja jeden do wielu dla MenuItem Ingredients') THEN
    ALTER TABLE "Ingredient" ADD "WHIngredientId" integer NOT NULL DEFAULT 0;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142339_Relacja jeden do wielu dla MenuItem Ingredients') THEN
    CREATE INDEX "IX_Ingredient_MenuItemId" ON "Ingredient" ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142339_Relacja jeden do wielu dla MenuItem Ingredients') THEN
    ALTER TABLE "Ingredient" ADD CONSTRAINT "FK_Ingredient_MenuItems_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItems" ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142339_Relacja jeden do wielu dla MenuItem Ingredients') THEN
    ALTER TABLE "MenuItems" ADD CONSTRAINT "FK_MenuItems_MenuCards_MenuId" FOREIGN KEY ("MenuId") REFERENCES "MenuCards" ("MenuCardId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142339_Relacja jeden do wielu dla MenuItem Ingredients') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124142339_Relacja jeden do wielu dla MenuItem Ingredients', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124142954_Ingredients - autonumerowanie') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124142954_Ingredients - autonumerowanie', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124144921_MenuCard zmiana podejścia bazy danych') THEN
    ALTER TABLE "MenuItems" DROP CONSTRAINT "FK_MenuItems_MenuCards_MenuId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124144921_MenuCard zmiana podejścia bazy danych') THEN
    DROP INDEX "IX_MenuItems_MenuId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124144921_MenuCard zmiana podejścia bazy danych') THEN
    ALTER TABLE "MenuItems" DROP COLUMN "MenuId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124144921_MenuCard zmiana podejścia bazy danych') THEN
    ALTER TABLE "MenuCards" ADD "MenuItemIds" integer[] NOT NULL DEFAULT ARRAY[]::integer[];
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124144921_MenuCard zmiana podejścia bazy danych') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124144921_MenuCard zmiana podejścia bazy danych', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124145029_MenuCard dodanie tytułu oraz opisu') THEN
    ALTER TABLE "MenuCards" ADD "Description" text NOT NULL DEFAULT '';
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124145029_MenuCard dodanie tytułu oraz opisu') THEN
    ALTER TABLE "MenuCards" ADD "Title" text NOT NULL DEFAULT '';
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124145029_MenuCard dodanie tytułu oraz opisu') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124145029_MenuCard dodanie tytułu oraz opisu', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124221404_Dodanie Calendars, Dodanie wielu interfejsów + repository + controllerow') THEN
    CREATE TABLE "Calendars" (
        "CalendarId" integer GENERATED BY DEFAULT AS IDENTITY,
        "Date" timestamp with time zone NOT NULL,
        "TotalOrders" integer NOT NULL,
        "Destination" text NOT NULL,
        CONSTRAINT "PK_Calendars" PRIMARY KEY ("CalendarId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124221404_Dodanie Calendars, Dodanie wielu interfejsów + repository + controllerow') THEN
    CREATE TABLE "Orders" (
        "OrderId" integer GENERATED BY DEFAULT AS IDENTITY,
        "OrderDate" timestamp with time zone NOT NULL,
        "CustomerName" text NOT NULL,
        "CustomerEmail" text NOT NULL,
        "CustomerPhone" text NOT NULL,
        "IsDelivery" boolean NOT NULL,
        "DeliveryAddress" text NOT NULL,
        "TotalAmount" numeric NOT NULL,
        CONSTRAINT "PK_Orders" PRIMARY KEY ("OrderId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124221404_Dodanie Calendars, Dodanie wielu interfejsów + repository + controllerow') THEN
    CREATE TABLE "Items" (
        "OrderItemId" integer GENERATED BY DEFAULT AS IDENTITY,
        "MenuItemId" integer NOT NULL,
        "Quantity" integer NOT NULL,
        "UnitPrice" numeric NOT NULL,
        "OrderId" integer NOT NULL,
        CONSTRAINT "PK_Items" PRIMARY KEY ("OrderItemId"),
        CONSTRAINT "FK_Items_MenuItems_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItems" ("MenuItemId") ON DELETE CASCADE,
        CONSTRAINT "FK_Items_Orders_OrderId" FOREIGN KEY ("OrderId") REFERENCES "Orders" ("OrderId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124221404_Dodanie Calendars, Dodanie wielu interfejsów + repository + controllerow') THEN
    CREATE INDEX "IX_Items_MenuItemId" ON "Items" ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124221404_Dodanie Calendars, Dodanie wielu interfejsów + repository + controllerow') THEN
    CREATE INDEX "IX_Items_OrderId" ON "Items" ("OrderId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124221404_Dodanie Calendars, Dodanie wielu interfejsów + repository + controllerow') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124221404_Dodanie Calendars, Dodanie wielu interfejsów + repository + controllerow', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124221806_Order - zmiana listy przedmiotów na listę id przedmiotów') THEN
    ALTER TABLE "Items" DROP CONSTRAINT "FK_Items_Orders_OrderId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124221806_Order - zmiana listy przedmiotów na listę id przedmiotów') THEN
    DROP INDEX "IX_Items_OrderId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124221806_Order - zmiana listy przedmiotów na listę id przedmiotów') THEN
    ALTER TABLE "Orders" ADD "OrderItemIds" integer[] NOT NULL DEFAULT ARRAY[]::integer[];
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231124221806_Order - zmiana listy przedmiotów na listę id przedmiotów') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231124221806_Order - zmiana listy przedmiotów na listę id przedmiotów', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231201081352_MenuCard - dodanie zdjęć jako byte[] & parametru isActive') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231201081352_MenuCard - dodanie zdjęć jako byte[] & parametru isActive', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231201091122_MenuCard - dodanie zdjęć powrot do stringa & parametru isActive') THEN
    ALTER TABLE "MenuCards" ALTER COLUMN image TYPE text;
    ALTER TABLE "MenuCards" ALTER COLUMN image DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231201091122_MenuCard - dodanie zdjęć powrot do stringa & parametru isActive') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231201091122_MenuCard - dodanie zdjęć powrot do stringa & parametru isActive', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231201101418_MenuCard - MenuItemIds can be null') THEN
    ALTER TABLE "MenuCards" ALTER COLUMN "MenuItemIds" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231201101418_MenuCard - MenuItemIds can be null') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231201101418_MenuCard - MenuItemIds can be null', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204103429_MenuCard - MenuItemIds can be null na menuitemids not null') THEN
    ALTER TABLE "MenuCards" RENAME COLUMN "MenuItemIds" TO menuitemids;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204103429_MenuCard - MenuItemIds can be null na menuitemids not null') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231204103429_MenuCard - MenuItemIds can be null na menuitemids not null', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204111513_MenuCard - MenuItemIds can be null and List menuitem') THEN
    ALTER TABLE "MenuCards" DROP COLUMN menuitemids;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204111513_MenuCard - MenuItemIds can be null and List menuitem') THEN
    ALTER TABLE "MenuItems" ADD "MenuCardId" integer NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204111513_MenuCard - MenuItemIds can be null and List menuitem') THEN
    CREATE INDEX "IX_MenuItems_MenuCardId" ON "MenuItems" ("MenuCardId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204111513_MenuCard - MenuItemIds can be null and List menuitem') THEN
    ALTER TABLE "MenuItems" ADD CONSTRAINT "FK_MenuItems_MenuCards_MenuCardId" FOREIGN KEY ("MenuCardId") REFERENCES "MenuCards" ("MenuCardId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204111513_MenuCard - MenuItemIds can be null and List menuitem') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231204111513_MenuCard - MenuItemIds can be null and List menuitem', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204113021_MenuCard - MenuItemIds can be null and List menuitem2') THEN
    ALTER TABLE "MenuItems" DROP CONSTRAINT "FK_MenuItems_MenuCards_MenuCardId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204113021_MenuCard - MenuItemIds can be null and List menuitem2') THEN
    DROP INDEX "IX_MenuItems_MenuCardId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204113021_MenuCard - MenuItemIds can be null and List menuitem2') THEN
    ALTER TABLE "MenuItems" DROP COLUMN "MenuCardId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204113021_MenuCard - MenuItemIds can be null and List menuitem2') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231204113021_MenuCard - MenuItemIds can be null and List menuitem2', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204113508_MenuCard - MenuItemIds can be null and List menuitem3') THEN
    CREATE TABLE "MenuItemCard" (
        "MenuItemId" integer GENERATED BY DEFAULT AS IDENTITY,
        "Name" text NOT NULL,
        "Description" text NOT NULL,
        "Category" text NOT NULL,
        "Price" numeric NOT NULL,
        "Availability" boolean NOT NULL,
        "Image" text NOT NULL,
        "PopularityRating" integer NOT NULL,
        "AllergenInformation" text NOT NULL,
        "IsVegetarian" boolean NOT NULL,
        "IsVegan" boolean NOT NULL,
        "LastUpdated" timestamp with time zone NOT NULL,
        "MenuCardId" integer NULL,
        CONSTRAINT "PK_MenuItemCard" PRIMARY KEY ("MenuItemId"),
        CONSTRAINT "FK_MenuItemCard_MenuCards_MenuCardId" FOREIGN KEY ("MenuCardId") REFERENCES "MenuCards" ("MenuCardId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204113508_MenuCard - MenuItemIds can be null and List menuitem3') THEN
    CREATE INDEX "IX_MenuItemCard_MenuCardId" ON "MenuItemCard" ("MenuCardId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231204113508_MenuCard - MenuItemIds can be null and List menuitem3') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231204113508_MenuCard - MenuItemIds can be null and List menuitem3', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219123956_Troche zmian') THEN
    ALTER TABLE "MenuItemCard" DROP CONSTRAINT "FK_MenuItemCard_MenuCards_MenuCardId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219123956_Troche zmian') THEN
    ALTER TABLE "MenuItemCard" DROP CONSTRAINT "PK_MenuItemCard";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219123956_Troche zmian') THEN
    ALTER TABLE "MenuItemCard" RENAME TO "MenuItemCards";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219123956_Troche zmian') THEN
    ALTER INDEX "IX_MenuItemCard_MenuCardId" RENAME TO "IX_MenuItemCards_MenuCardId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219123956_Troche zmian') THEN
    ALTER TABLE "MenuItemCards" ALTER COLUMN "MenuCardId" SET NOT NULL;
    ALTER TABLE "MenuItemCards" ALTER COLUMN "MenuCardId" SET DEFAULT 0;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219123956_Troche zmian') THEN
    ALTER TABLE "MenuItemCards" ADD CONSTRAINT "PK_MenuItemCards" PRIMARY KEY ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219123956_Troche zmian') THEN
    ALTER TABLE "MenuItemCards" ADD CONSTRAINT "FK_MenuItemCards_MenuCards_MenuCardId" FOREIGN KEY ("MenuCardId") REFERENCES "MenuCards" ("MenuCardId") ON DELETE CASCADE;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219123956_Troche zmian') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231219123956_Troche zmian', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219124708_Troche zmian2') THEN
    ALTER TABLE "MenuItemCards" DROP CONSTRAINT "FK_MenuItemCards_MenuCards_MenuCardId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219124708_Troche zmian2') THEN
    DROP INDEX "IX_MenuItemCards_MenuCardId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219124708_Troche zmian2') THEN
    CREATE TABLE "MenuCardMenuItemCards" (
        "MenuCardId" integer NOT NULL,
        "MenuItemCardId" integer NOT NULL,
        CONSTRAINT "PK_MenuCardMenuItemCards" PRIMARY KEY ("MenuCardId", "MenuItemCardId"),
        CONSTRAINT "FK_MenuCardMenuItemCards_MenuCards_MenuCardId" FOREIGN KEY ("MenuCardId") REFERENCES "MenuCards" ("MenuCardId") ON DELETE CASCADE,
        CONSTRAINT "FK_MenuCardMenuItemCards_MenuItemCards_MenuItemCardId" FOREIGN KEY ("MenuItemCardId") REFERENCES "MenuItemCards" ("MenuItemId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219124708_Troche zmian2') THEN
    CREATE INDEX "IX_MenuCardMenuItemCards_MenuItemCardId" ON "MenuCardMenuItemCards" ("MenuItemCardId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219124708_Troche zmian2') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231219124708_Troche zmian2', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219125641_Troche zmian3') THEN
    ALTER TABLE "MenuItemCards" RENAME COLUMN "MenuItemId" TO "MenuItemCardId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231219125641_Troche zmian3') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231219125641_Troche zmian3', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231220073824_Troche zmian4') THEN
    ALTER TABLE "WarehouseData" ADD "productImage" text NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20231220073824_Troche zmian4') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20231220073824_Troche zmian4', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110133218_Zmiany w menuitem') THEN
    ALTER TABLE "MenuItems" RENAME COLUMN "AllergenInformation" TO allergeninformation;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110133218_Zmiany w menuitem') THEN
    ALTER TABLE "MenuItems" ADD "SKU" integer NOT NULL DEFAULT 0;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110133218_Zmiany w menuitem') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240110133218_Zmiany w menuitem', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110151810_Zmiany w menuitem2') THEN
    ALTER TABLE "MenuItems" RENAME COLUMN allergeninformation TO "ALLERGENINFORMATION";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110151810_Zmiany w menuitem2') THEN
    ALTER TABLE "MenuItems" RENAME COLUMN "Category" TO "CATEGORY";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110151810_Zmiany w menuitem2') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240110151810_Zmiany w menuitem2', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110153737_Zmiany w menuitem3') THEN
    DROP TABLE "Ingredient";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110153737_Zmiany w menuitem3') THEN
    ALTER TABLE "MenuItems" ADD "Ingredients" text NOT NULL DEFAULT '';
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110153737_Zmiany w menuitem3') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240110153737_Zmiany w menuitem3', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110160440_Zmiany w menuitem4') THEN
    ALTER TABLE "MenuItems" DROP COLUMN "ALLERGENINFORMATION";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110160440_Zmiany w menuitem4') THEN
    ALTER TABLE "MenuItems" DROP COLUMN "Ingredients";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110160440_Zmiany w menuitem4') THEN
    ALTER TABLE "MenuItems" RENAME COLUMN "CATEGORY" TO "Category";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110160440_Zmiany w menuitem4') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "SKU" TYPE text;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110160440_Zmiany w menuitem4') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "PopularityRating" TYPE text;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110160440_Zmiany w menuitem4') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240110160440_Zmiany w menuitem4', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110160826_Zmiany w menuitem5') THEN
    ALTER TABLE "MenuItems" DROP COLUMN "Category";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110160826_Zmiany w menuitem5') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240110160826_Zmiany w menuitem5', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110163326_Zmiany w menuitem6') THEN
    ALTER TABLE "MenuItems" ADD "ALLERGENINFORMATION" text[] NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110163326_Zmiany w menuitem6') THEN
    CREATE TABLE "CATEGORY" (
        "CategoryId" integer GENERATED BY DEFAULT AS IDENTITY,
        "productCategoryId" integer NULL,
        "categoryName" text NULL,
        description text NULL,
        CONSTRAINT "PK_CATEGORY" PRIMARY KEY ("CategoryId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110163326_Zmiany w menuitem6') THEN
    CREATE TABLE "Ingredient" (
        "IngredientId" integer GENERATED BY DEFAULT AS IDENTITY,
        "ProductId" integer NULL,
        "ProductSKU" integer NULL,
        "ProductName" text NULL,
        "ProductDescription" text NULL,
        "ProductCategoryId" text NULL,
        "ProductQuantity" integer NULL,
        "ProductNettoPrice" numeric NULL,
        "ProductVatRate" integer NULL,
        "ProductExpiresDays" integer NULL,
        "ProductExpiresDate" timestamp with time zone NULL,
        "ProductImage" text NULL,
        CONSTRAINT "PK_Ingredient" PRIMARY KEY ("IngredientId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110163326_Zmiany w menuitem6') THEN
    CREATE TABLE "MenuItemCategory" (
        "MenuItemId" integer NOT NULL,
        "CategoryId" integer NOT NULL,
        "MenuItemId1" integer NOT NULL,
        CONSTRAINT "PK_MenuItemCategory" PRIMARY KEY ("MenuItemId", "CategoryId"),
        CONSTRAINT "FK_MenuItemCategory_CATEGORY_CategoryId" FOREIGN KEY ("CategoryId") REFERENCES "CATEGORY" ("CategoryId") ON DELETE CASCADE,
        CONSTRAINT "FK_MenuItemCategory_MenuItems_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItems" ("MenuItemId") ON DELETE CASCADE,
        CONSTRAINT "FK_MenuItemCategory_MenuItems_MenuItemId1" FOREIGN KEY ("MenuItemId1") REFERENCES "MenuItems" ("MenuItemId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110163326_Zmiany w menuitem6') THEN
    CREATE TABLE "MenuItemIngredient" (
        "MenuItemId" integer NOT NULL,
        "IngredientId" integer NOT NULL,
        "MenuItemId1" integer NOT NULL,
        CONSTRAINT "PK_MenuItemIngredient" PRIMARY KEY ("MenuItemId", "IngredientId"),
        CONSTRAINT "FK_MenuItemIngredient_Ingredient_IngredientId" FOREIGN KEY ("IngredientId") REFERENCES "Ingredient" ("IngredientId") ON DELETE CASCADE,
        CONSTRAINT "FK_MenuItemIngredient_MenuItems_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItems" ("MenuItemId") ON DELETE CASCADE,
        CONSTRAINT "FK_MenuItemIngredient_MenuItems_MenuItemId1" FOREIGN KEY ("MenuItemId1") REFERENCES "MenuItems" ("MenuItemId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110163326_Zmiany w menuitem6') THEN
    CREATE INDEX "IX_MenuItemCategory_CategoryId" ON "MenuItemCategory" ("CategoryId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110163326_Zmiany w menuitem6') THEN
    CREATE INDEX "IX_MenuItemCategory_MenuItemId1" ON "MenuItemCategory" ("MenuItemId1");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110163326_Zmiany w menuitem6') THEN
    CREATE INDEX "IX_MenuItemIngredient_IngredientId" ON "MenuItemIngredient" ("IngredientId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110163326_Zmiany w menuitem6') THEN
    CREATE INDEX "IX_MenuItemIngredient_MenuItemId1" ON "MenuItemIngredient" ("MenuItemId1");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240110163326_Zmiany w menuitem6') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240110163326_Zmiany w menuitem6', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "MenuItemCategory" DROP CONSTRAINT "FK_MenuItemCategory_CATEGORY_CategoryId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "MenuItemCategory" DROP CONSTRAINT "FK_MenuItemCategory_MenuItems_MenuItemId1";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    DROP TABLE "MenuItemIngredient";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "MenuItemCategory" DROP CONSTRAINT "PK_MenuItemCategory";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    DROP INDEX "IX_MenuItemCategory_CategoryId";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    DROP INDEX "IX_MenuItemCategory_MenuItemId1";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "CATEGORY" DROP CONSTRAINT "PK_CATEGORY";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "Ingredient" DROP CONSTRAINT "PK_Ingredient";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "MenuItemCategory" DROP COLUMN "MenuItemId1";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "CATEGORY" RENAME TO "Category";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "Ingredient" RENAME TO "Ingredients";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "MenuItemCategory" RENAME COLUMN "CategoryId" TO "CATEGORYID";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "Category" RENAME COLUMN "CategoryId" TO "ID";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "MenuItemCategory" ADD CONSTRAINT "PK_MenuItemCategory" PRIMARY KEY ("CATEGORYID", "MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "Category" ADD CONSTRAINT "PK_Category" PRIMARY KEY ("ID");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "Ingredients" ADD CONSTRAINT "PK_Ingredients" PRIMARY KEY ("IngredientId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    CREATE TABLE "MenuItemIngredients" (
        "IngredientsIngredientId" integer NOT NULL,
        "MenuItemId" integer NOT NULL,
        CONSTRAINT "PK_MenuItemIngredients" PRIMARY KEY ("IngredientsIngredientId", "MenuItemId"),
        CONSTRAINT "FK_MenuItemIngredients_Ingredients_IngredientsIngredientId" FOREIGN KEY ("IngredientsIngredientId") REFERENCES "Ingredients" ("IngredientId") ON DELETE CASCADE,
        CONSTRAINT "FK_MenuItemIngredients_MenuItems_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItems" ("MenuItemId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    CREATE INDEX "IX_MenuItemCategory_MenuItemId" ON "MenuItemCategory" ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    CREATE INDEX "IX_MenuItemIngredients_MenuItemId" ON "MenuItemIngredients" ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    ALTER TABLE "MenuItemCategory" ADD CONSTRAINT "FK_MenuItemCategory_Category_CATEGORYID" FOREIGN KEY ("CATEGORYID") REFERENCES "Category" ("ID") ON DELETE CASCADE;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240111130018_Zmiany w migracjach') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240111130018_Zmiany w migracjach', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240112150613_Zmiany w mig2') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "PopularityRating" TYPE double precision;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240112150613_Zmiany w mig2') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240112150613_Zmiany w mig2', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240115092925_menuitem add availabledays') THEN
    ALTER TABLE "MenuItems" ADD "AvailableDays" text[] NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240115092925_menuitem add availabledays') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240115092925_menuitem add availabledays', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240115095341_Wielkie zmiany w działaniu MenuCard z MenuItem') THEN
    DROP TABLE "MenuCardMenuItemCards";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240115095341_Wielkie zmiany w działaniu MenuCard z MenuItem') THEN
    DROP TABLE "MenuItemCards";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240115095341_Wielkie zmiany w działaniu MenuCard z MenuItem') THEN
    CREATE TABLE "MenuCardMenuItem" (
        "MenuCardId" integer NOT NULL,
        "MenuItemId" integer NOT NULL,
        CONSTRAINT "PK_MenuCardMenuItem" PRIMARY KEY ("MenuCardId", "MenuItemId"),
        CONSTRAINT "FK_MenuCardMenuItem_MenuCards_MenuCardId" FOREIGN KEY ("MenuCardId") REFERENCES "MenuCards" ("MenuCardId") ON DELETE CASCADE,
        CONSTRAINT "FK_MenuCardMenuItem_MenuItems_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItems" ("MenuItemId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240115095341_Wielkie zmiany w działaniu MenuCard z MenuItem') THEN
    CREATE INDEX "IX_MenuCardMenuItem_MenuItemId" ON "MenuCardMenuItem" ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240115095341_Wielkie zmiany w działaniu MenuCard z MenuItem') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240115095341_Wielkie zmiany w działaniu MenuCard z MenuItem', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    DROP TABLE "Items";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    ALTER TABLE "Orders" DROP COLUMN "OrderItemIds";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE TABLE "CustomerCompany" (
        "Id" integer GENERATED BY DEFAULT AS IDENTITY,
        "Name" text NOT NULL,
        "Address" text NOT NULL,
        CONSTRAINT "PK_CustomerCompany" PRIMARY KEY ("Id")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE TABLE "OrderMenuItem" (
        "MenuItemId" integer NOT NULL,
        "OrderId" integer NOT NULL,
        CONSTRAINT "PK_OrderMenuItem" PRIMARY KEY ("MenuItemId", "OrderId"),
        CONSTRAINT "FK_OrderMenuItem_MenuItems_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItems" ("MenuItemId") ON DELETE CASCADE,
        CONSTRAINT "FK_OrderMenuItem_Orders_OrderId" FOREIGN KEY ("OrderId") REFERENCES "Orders" ("OrderId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE TABLE "OrderPayments" (
        "Id" integer GENERATED BY DEFAULT AS IDENTITY,
        "Value" double precision NOT NULL,
        "PaymentName" text NOT NULL,
        CONSTRAINT "PK_OrderPayments" PRIMARY KEY ("Id")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE TABLE "OrderShipment" (
        "Id" integer GENERATED BY DEFAULT AS IDENTITY,
        "Address" text NOT NULL,
        "PhoneNumber" integer NOT NULL,
        CONSTRAINT "PK_OrderShipment" PRIMARY KEY ("Id")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE TABLE "OrderStatus" (
        "Id" integer GENERATED BY DEFAULT AS IDENTITY,
        "Status" text NOT NULL,
        "StatusDate" timestamp with time zone NOT NULL,
        CONSTRAINT "PK_OrderStatus" PRIMARY KEY ("Id")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE TABLE "UserData" (
        "UserId" text NOT NULL,
        "Username" text NULL,
        "Email" text NULL,
        "Name" text NULL,
        "Surname" text NULL,
        "Position" text NULL,
        "ProfilePicture" bytea NULL,
        "Role" text NULL,
        "MarginalRate" double precision NULL,
        CONSTRAINT "PK_UserData" PRIMARY KEY ("UserId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE TABLE "OrderOrderPayments" (
        "OrderId" integer NOT NULL,
        "OrderPaymentsId" integer NOT NULL,
        CONSTRAINT "PK_OrderOrderPayments" PRIMARY KEY ("OrderId", "OrderPaymentsId"),
        CONSTRAINT "FK_OrderOrderPayments_OrderPayments_OrderPaymentsId" FOREIGN KEY ("OrderPaymentsId") REFERENCES "OrderPayments" ("Id") ON DELETE CASCADE,
        CONSTRAINT "FK_OrderOrderPayments_Orders_OrderId" FOREIGN KEY ("OrderId") REFERENCES "Orders" ("OrderId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE TABLE "OrderOrderShipment" (
        "OrderId" integer NOT NULL,
        "OrderShipmentId" integer NOT NULL,
        CONSTRAINT "PK_OrderOrderShipment" PRIMARY KEY ("OrderId", "OrderShipmentId"),
        CONSTRAINT "FK_OrderOrderShipment_Orders_OrderId" FOREIGN KEY ("OrderId") REFERENCES "Orders" ("OrderId") ON DELETE CASCADE,
        CONSTRAINT "FK_OrderOrderShipment_OrderShipment_OrderShipmentId" FOREIGN KEY ("OrderShipmentId") REFERENCES "OrderShipment" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE TABLE "OrderOrderStatus" (
        "OrderId" integer NOT NULL,
        "OrderStatusId" integer NOT NULL,
        CONSTRAINT "PK_OrderOrderStatus" PRIMARY KEY ("OrderId", "OrderStatusId"),
        CONSTRAINT "FK_OrderOrderStatus_Orders_OrderId" FOREIGN KEY ("OrderId") REFERENCES "Orders" ("OrderId") ON DELETE CASCADE,
        CONSTRAINT "FK_OrderOrderStatus_OrderStatus_OrderStatusId" FOREIGN KEY ("OrderStatusId") REFERENCES "OrderStatus" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE TABLE "UserDataCustomerCompany" (
        "CustomerCompanyId" integer NOT NULL,
        "UserDataUserId" text NOT NULL,
        CONSTRAINT "PK_UserDataCustomerCompany" PRIMARY KEY ("CustomerCompanyId", "UserDataUserId"),
        CONSTRAINT "FK_UserDataCustomerCompany_CustomerCompany_CustomerCompanyId" FOREIGN KEY ("CustomerCompanyId") REFERENCES "CustomerCompany" ("Id") ON DELETE CASCADE,
        CONSTRAINT "FK_UserDataCustomerCompany_UserData_UserDataUserId" FOREIGN KEY ("UserDataUserId") REFERENCES "UserData" ("UserId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE INDEX "IX_OrderMenuItem_OrderId" ON "OrderMenuItem" ("OrderId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE INDEX "IX_OrderOrderPayments_OrderPaymentsId" ON "OrderOrderPayments" ("OrderPaymentsId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE INDEX "IX_OrderOrderShipment_OrderShipmentId" ON "OrderOrderShipment" ("OrderShipmentId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE INDEX "IX_OrderOrderStatus_OrderStatusId" ON "OrderOrderStatus" ("OrderStatusId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    CREATE INDEX "IX_UserDataCustomerCompany_UserDataUserId" ON "UserDataCustomerCompany" ("UserDataUserId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117085917_Wielkie zmiany w działaniu Order') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240117085917_Wielkie zmiany w działaniu Order', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    DROP TABLE "OrderMenuItem";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "SKU" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "PopularityRating" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "IsVegetarian" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "IsVegan" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "Image" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "Description" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    ALTER TABLE "MenuItems" ALTER COLUMN "Availability" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    CREATE TABLE "MenuItemDTO" (
        "Id" integer GENERATED BY DEFAULT AS IDENTITY,
        "MenuItemId" integer NOT NULL,
        "Name" text NOT NULL,
        "Description" text NULL,
        "SKU" text NULL,
        "Price" numeric NOT NULL,
        "Availability" boolean NULL,
        "Image" text NULL,
        "PopularityRating" double precision NULL,
        CONSTRAINT "PK_MenuItemDTO" PRIMARY KEY ("Id")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    CREATE TABLE "OrderMenuItemDTO" (
        "MenuItemDTOId" integer NOT NULL,
        "OrderId" integer NOT NULL,
        CONSTRAINT "PK_OrderMenuItemDTO" PRIMARY KEY ("MenuItemDTOId", "OrderId"),
        CONSTRAINT "FK_OrderMenuItemDTO_MenuItemDTO_MenuItemDTOId" FOREIGN KEY ("MenuItemDTOId") REFERENCES "MenuItemDTO" ("Id") ON DELETE CASCADE,
        CONSTRAINT "FK_OrderMenuItemDTO_Orders_OrderId" FOREIGN KEY ("OrderId") REFERENCES "Orders" ("OrderId") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    CREATE INDEX "IX_OrderMenuItemDTO_OrderId" ON "OrderMenuItemDTO" ("OrderId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240117150629_Wielkie zmiany w działaniu Order2') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240117150629_Wielkie zmiany w działaniu Order2', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111238_Wielkie zmiany w działaniu Order3') THEN
    ALTER TABLE "OrderStatus" ALTER COLUMN "StatusDate" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111238_Wielkie zmiany w działaniu Order3') THEN
    ALTER TABLE "OrderStatus" ALTER COLUMN "Status" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111238_Wielkie zmiany w działaniu Order3') THEN
    ALTER TABLE "OrderShipment" ALTER COLUMN "PhoneNumber" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111238_Wielkie zmiany w działaniu Order3') THEN
    ALTER TABLE "OrderShipment" ALTER COLUMN "Address" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111238_Wielkie zmiany w działaniu Order3') THEN
    ALTER TABLE "OrderShipment" ADD "CreatedTime" timestamp with time zone NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111238_Wielkie zmiany w działaniu Order3') THEN
    ALTER TABLE "OrderPayments" ALTER COLUMN "Value" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111238_Wielkie zmiany w działaniu Order3') THEN
    ALTER TABLE "OrderPayments" ALTER COLUMN "PaymentName" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111238_Wielkie zmiany w działaniu Order3') THEN
    ALTER TABLE "OrderPayments" ADD "PaymentDate" timestamp with time zone NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111238_Wielkie zmiany w działaniu Order3') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240118111238_Wielkie zmiany w działaniu Order3', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111727_dodanie MenuItemDTO') THEN
    DROP TABLE "MenuCardMenuItem";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111727_dodanie MenuItemDTO') THEN
    ALTER TABLE "MenuCards" ADD "MenuItemId" integer NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111727_dodanie MenuItemDTO') THEN
    CREATE TABLE "MenuCardMenuItemDTO" (
        "MenuCardId" integer NOT NULL,
        "MenuItemId" integer NOT NULL,
        CONSTRAINT "PK_MenuCardMenuItemDTO" PRIMARY KEY ("MenuCardId", "MenuItemId"),
        CONSTRAINT "FK_MenuCardMenuItemDTO_MenuCards_MenuCardId" FOREIGN KEY ("MenuCardId") REFERENCES "MenuCards" ("MenuCardId") ON DELETE CASCADE,
        CONSTRAINT "FK_MenuCardMenuItemDTO_MenuItemDTO_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItemDTO" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111727_dodanie MenuItemDTO') THEN
    CREATE INDEX "IX_MenuCards_MenuItemId" ON "MenuCards" ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111727_dodanie MenuItemDTO') THEN
    CREATE INDEX "IX_MenuCardMenuItemDTO_MenuItemId" ON "MenuCardMenuItemDTO" ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111727_dodanie MenuItemDTO') THEN
    ALTER TABLE "MenuCards" ADD CONSTRAINT "FK_MenuCards_MenuItems_MenuItemId" FOREIGN KEY ("MenuItemId") REFERENCES "MenuItems" ("MenuItemId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118111727_dodanie MenuItemDTO') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240118111727_dodanie MenuItemDTO', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118113932_dodanie UserDataDTO oraz CustomerDataDTO') THEN
    ALTER TABLE "Orders" DROP COLUMN "CustomerEmail";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118113932_dodanie UserDataDTO oraz CustomerDataDTO') THEN
    ALTER TABLE "Orders" DROP COLUMN "CustomerName";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118113932_dodanie UserDataDTO oraz CustomerDataDTO') THEN
    ALTER TABLE "Orders" DROP COLUMN "CustomerPhone";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118113932_dodanie UserDataDTO oraz CustomerDataDTO') THEN
    CREATE TABLE "CustomerCompanyDTO" (
        "Id" integer GENERATED BY DEFAULT AS IDENTITY,
        "Name" text NOT NULL,
        "Address" text NOT NULL,
        CONSTRAINT "PK_CustomerCompanyDTO" PRIMARY KEY ("Id")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118113932_dodanie UserDataDTO oraz CustomerDataDTO') THEN
    CREATE TABLE "UserDataDTO" (
        "Id" integer GENERATED BY DEFAULT AS IDENTITY,
        "UserId" text NULL,
        "Username" text NULL,
        "Email" text NULL,
        "Name" text NULL,
        "Surname" text NULL,
        "Position" text NULL,
        "ProfilePicture" bytea NULL,
        "Role" text NULL,
        "MarginalRate" double precision NULL,
        "OrderId" integer NULL,
        CONSTRAINT "PK_UserDataDTO" PRIMARY KEY ("Id"),
        CONSTRAINT "FK_UserDataDTO_Orders_OrderId" FOREIGN KEY ("OrderId") REFERENCES "Orders" ("OrderId")
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118113932_dodanie UserDataDTO oraz CustomerDataDTO') THEN
    CREATE TABLE "CustomerCompanyDTOUserDataDTO" (
        "CustomerCompanyDTOId" integer NOT NULL,
        "UserDataDTOId" integer NOT NULL,
        CONSTRAINT "PK_CustomerCompanyDTOUserDataDTO" PRIMARY KEY ("CustomerCompanyDTOId", "UserDataDTOId"),
        CONSTRAINT "FK_CustomerCompanyDTOUserDataDTO_CustomerCompanyDTO_CustomerCo~" FOREIGN KEY ("CustomerCompanyDTOId") REFERENCES "CustomerCompanyDTO" ("Id") ON DELETE CASCADE,
        CONSTRAINT "FK_CustomerCompanyDTOUserDataDTO_UserDataDTO_UserDataDTOId" FOREIGN KEY ("UserDataDTOId") REFERENCES "UserDataDTO" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118113932_dodanie UserDataDTO oraz CustomerDataDTO') THEN
    CREATE INDEX "IX_CustomerCompanyDTOUserDataDTO_UserDataDTOId" ON "CustomerCompanyDTOUserDataDTO" ("UserDataDTOId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118113932_dodanie UserDataDTO oraz CustomerDataDTO') THEN
    CREATE INDEX "IX_UserDataDTO_OrderId" ON "UserDataDTO" ("OrderId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118113932_dodanie UserDataDTO oraz CustomerDataDTO') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240118113932_dodanie UserDataDTO oraz CustomerDataDTO', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118120930_Rozne aktualizacje') THEN
    ALTER TABLE "UserDataDTO" RENAME COLUMN "Email" TO "UserEmail";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240118120930_Rozne aktualizacje') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240118120930_Rozne aktualizacje', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240119072602_UserDataDTO zmiana name i surname na displayName') THEN
    ALTER TABLE "UserDataDTO" DROP COLUMN "Name";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240119072602_UserDataDTO zmiana name i surname na displayName') THEN
    ALTER TABLE "UserDataDTO" RENAME COLUMN "Surname" TO "displayName";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240119072602_UserDataDTO zmiana name i surname na displayName') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240119072602_UserDataDTO zmiana name i surname na displayName', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240119073623_MenuItemDTO dodanie quantity') THEN
    ALTER TABLE "MenuItemDTO" ADD "Quantity" integer NOT NULL DEFAULT 0;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240119073623_MenuItemDTO dodanie quantity') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240119073623_MenuItemDTO dodanie quantity', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123075529_Zmiany w orders') THEN
    ALTER TABLE "Orders" DROP COLUMN "DeliveryAddress";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123075529_Zmiany w orders') THEN
    ALTER TABLE "Orders" ALTER COLUMN "TotalAmount" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123075529_Zmiany w orders') THEN
    ALTER TABLE "Orders" ALTER COLUMN "IsDelivery" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123075529_Zmiany w orders') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240123075529_Zmiany w orders', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110153_Zmiany w strukturach baz danych') THEN
    ALTER TABLE "UserDataDTO" DROP COLUMN "MarginalRate";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110153_Zmiany w strukturach baz danych') THEN
    ALTER TABLE "UserDataDTO" DROP COLUMN "Position";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110153_Zmiany w strukturach baz danych') THEN
    ALTER TABLE "UserDataDTO" DROP COLUMN "ProfilePicture";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110153_Zmiany w strukturach baz danych') THEN
    ALTER TABLE "UserDataDTO" DROP COLUMN "Role";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110153_Zmiany w strukturach baz danych') THEN
    ALTER TABLE "UserDataDTO" DROP COLUMN "UserEmail";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110153_Zmiany w strukturach baz danych') THEN
    ALTER TABLE "UserDataDTO" DROP COLUMN "Username";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110153_Zmiany w strukturach baz danych') THEN
    ALTER TABLE "UserDataDTO" DROP COLUMN "displayName";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110153_Zmiany w strukturach baz danych') THEN
    ALTER TABLE "UserData" ADD "isActive" boolean NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110153_Zmiany w strukturach baz danych') THEN
    ALTER TABLE "AspNetUsers" ADD "IsActive" boolean NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110153_Zmiany w strukturach baz danych') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240123110153_Zmiany w strukturach baz danych', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110522_Zmiany w strukturach baz danych2') THEN
    ALTER TABLE "UserDataDTO" ADD "DisplayName" text NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110522_Zmiany w strukturach baz danych2') THEN
    ALTER TABLE "UserDataDTO" ADD "MarginalRate" double precision NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110522_Zmiany w strukturach baz danych2') THEN
    ALTER TABLE "UserDataDTO" ADD "Position" text NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110522_Zmiany w strukturach baz danych2') THEN
    ALTER TABLE "UserDataDTO" ADD "ProfilePicture" bytea NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110522_Zmiany w strukturach baz danych2') THEN
    ALTER TABLE "UserDataDTO" ADD "Role" text NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110522_Zmiany w strukturach baz danych2') THEN
    ALTER TABLE "UserDataDTO" ADD "UserEmail" text NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110522_Zmiany w strukturach baz danych2') THEN
    ALTER TABLE "UserDataDTO" ADD "Username" text NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240123110522_Zmiany w strukturach baz danych2') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240123110522_Zmiany w strukturach baz danych2', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240124103222_Zmiany w strukturach danych Użytkownika') THEN
    CREATE TABLE "ApllicationUserCustomerCompany" (
        "ApplicationUserId" text NOT NULL,
        "CustomerCompanyId" integer NOT NULL,
        CONSTRAINT "PK_ApllicationUserCustomerCompany" PRIMARY KEY ("ApplicationUserId", "CustomerCompanyId"),
        CONSTRAINT "FK_ApllicationUserCustomerCompany_AspNetUsers_ApplicationUserId" FOREIGN KEY ("ApplicationUserId") REFERENCES "AspNetUsers" ("Id") ON DELETE CASCADE,
        CONSTRAINT "FK_ApllicationUserCustomerCompany_CustomerCompany_CustomerComp~" FOREIGN KEY ("CustomerCompanyId") REFERENCES "CustomerCompany" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240124103222_Zmiany w strukturach danych Użytkownika') THEN
    CREATE INDEX "IX_ApllicationUserCustomerCompany_CustomerCompanyId" ON "ApllicationUserCustomerCompany" ("CustomerCompanyId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240124103222_Zmiany w strukturach danych Użytkownika') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240124103222_Zmiany w strukturach danych Użytkownika', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240124110250_Zmiany w strukturach danych Użytkownika2') THEN
    DROP TABLE "ApllicationUserCustomerCompany";
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240124110250_Zmiany w strukturach danych Użytkownika2') THEN
    CREATE TABLE "ApllicationUserCustomerCompanyDTO" (
        "ApplicationUserId" text NOT NULL,
        "CustomerCompanyDTOId" integer NOT NULL,
        CONSTRAINT "PK_ApllicationUserCustomerCompanyDTO" PRIMARY KEY ("ApplicationUserId", "CustomerCompanyDTOId"),
        CONSTRAINT "FK_ApllicationUserCustomerCompanyDTO_AspNetUsers_ApplicationUs~" FOREIGN KEY ("ApplicationUserId") REFERENCES "AspNetUsers" ("Id") ON DELETE CASCADE,
        CONSTRAINT "FK_ApllicationUserCustomerCompanyDTO_CustomerCompanyDTO_Custom~" FOREIGN KEY ("CustomerCompanyDTOId") REFERENCES "CustomerCompanyDTO" ("Id") ON DELETE CASCADE
    );
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240124110250_Zmiany w strukturach danych Użytkownika2') THEN
    CREATE INDEX "IX_ApllicationUserCustomerCompanyDTO_CustomerCompanyDTOId" ON "ApllicationUserCustomerCompanyDTO" ("CustomerCompanyDTOId");
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240124110250_Zmiany w strukturach danych Użytkownika2') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240124110250_Zmiany w strukturach danych Użytkownika2', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240125110242_Image for categories') THEN
    ALTER TABLE "ProductCategories" ALTER COLUMN "Description" DROP NOT NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240125110242_Image for categories') THEN
    ALTER TABLE "ProductCategories" ADD image text NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240125110242_Image for categories') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240125110242_Image for categories', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240208081231_Zmiany fundamentalne pod obliczanie portfeli użytkowników') THEN
    ALTER TABLE "UserData" ADD "Credits" double precision NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240208081231_Zmiany fundamentalne pod obliczanie portfeli użytkowników') THEN
    ALTER TABLE "AspNetUsers" ADD "Credits" double precision NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240208081231_Zmiany fundamentalne pod obliczanie portfeli użytkowników') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240208081231_Zmiany fundamentalne pod obliczanie portfeli użytkowników', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240214004942_Zmiany fundamentalne pod obliczanie portfeli użytkowników2') THEN
    ALTER TABLE "AspNetUsers" ADD "DailyCredits" double precision NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240214004942_Zmiany fundamentalne pod obliczanie portfeli użytkowników2') THEN
    ALTER TABLE "AspNetUsers" ADD "WorkDays" integer NULL;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240214004942_Zmiany fundamentalne pod obliczanie portfeli użytkowników2') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240214004942_Zmiany fundamentalne pod obliczanie portfeli użytkowników2', '6.0.7');
    END IF;
END $EF$;
COMMIT;

START TRANSACTION;


DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240319082112_Zmiany w WarehouseData') THEN
    ALTER TABLE "WarehouseData" ALTER COLUMN "ProductSKU" TYPE text;
    END IF;
END $EF$;

DO $EF$
BEGIN
    IF NOT EXISTS(SELECT 1 FROM "__EFMigrationsHistory" WHERE "MigrationId" = '20240319082112_Zmiany w WarehouseData') THEN
    INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
    VALUES ('20240319082112_Zmiany w WarehouseData', '6.0.7');
    END IF;
END $EF$;
COMMIT;

